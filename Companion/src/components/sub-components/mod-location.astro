---
import type { ImageMetadata } from 'astro';
import { Image } from 'astro:assets';

const path = '/src/assets/mods-locations/';

interface Props {
   modName: string;
}
const { modName } = Astro.props;

const images = import.meta.glob<{ default: ImageMetadata }>(`/src/assets/mods-locations/*.{jpeg,jpg,png,gif}`);

const formats = ['jpeg','jpg','png','gif'];
let imagePath = ``;
formats.forEach((format) => {
    const possiblePath = `${path}${modName}.${format}`;
    if(images[possiblePath]) {
        imagePath = possiblePath;
    }
});

if (!images[imagePath]) throw new Error(`${modName}" does not exist in glob: "${path}*.{jpeg,jpg,png,gif}`);

const image = await images[imagePath]();
const src = image.default;
---

<Image 
    {src}
    alt=`Map location for ${modName}` 
    widths={[240, 540, 720, src.width]}
    sizes={`(max-width: 360px) 240px, (max-width: 720px) 540px, (max-width: 1080px) 720px, ${src.width}px`}
/>
